window.app={},$(function(e){setTimeout(function(){e("#load").fadeOut()},600)}),function(){app.TodoModel=Backbone.Model.extend({defaults:{title:"",isCompleted:!1},toggle:function(){this.save({isCompleted:!this.get("isCompleted")})}})}(),function(){app.TodoCollection=Backbone.Collection.extend({model:app.TodoModel,localStorage:new Backbone.LocalStorage("todos-backbone"),done:function(){return this.where({isCompleted:!0})},remaining:function(){return this.where({isCompleted:!1})}}),app.todos=new app.TodoCollection}(),function(){app.TodoItemView=Backbone.View.extend({tagName:"li",className:"todo-item",events:{"click .destroy":"destroyModel","click input.toggle":"toggleTodo","dblclick .view label":"editing","keypress .edit":"endEdit","blur .edit":"updateTitleTodo"},destroyModel:function(){this.model.destroy()},removeView:function(){this.$el.slideUp("fast",function(){this.$el.remove()}.bind(this))},toggleTodo:function(){this.model.toggle()},updateTitleTodo:function(){var e=this.$(".edit").val().trim();e&&this.model.save({title:e}),this.$el.removeClass("editing")},editing:function(){this.$el.addClass("editing"),this.$(".edit").focus()},endEdit:function(){(event.which&&13==event.which||event.keyCode&&13==event.keyCode)&&this.updateTitleTodo()},toggleView:function(){var e=this.model.get("isCompleted");this.$(".toggle").prop("checked",e),this.$el.toggleClass("completed",e)},updateTitleView:function(){var e=this.model.get("title");this.$("label").html(e)},hideView:function(){this.isHidden()?this.$el.slideUp("fast"):this.$el.slideDown("fast")},isHidden:function(){return this.model.get("isCompleted")?"active"==app.todoFilter:"completed"==app.todoFilter},initialize:function(){this.listenTo(this.model,"destroy",this.removeView),this.listenTo(this.model,"change:isCompleted",this.toggleView),this.listenTo(this.model,"change:title",this.updateTitleView),this.listenTo(this.model,"hide",this.hideView)},template:_.template($("#item_template").html()),render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$el.toggleClass("completed",this.model.get("isCompleted")),this}})}(),function(){app.TodoAppView=Backbone.View.extend({el:".todoapp",statsTemplate:_.template($("#stats_template").html()),events:{"keypress input.new-todo":"newTodo","click .clear-completed":"clearCompleted","click .toggle-all":"toggleAll"},toggleAll:function(){app.todos.each(function(e){e.toggle()})},clearCompleted:function(){_.invoke(app.todos.done(),"destroy")},newTodo:function(e){var t=this.$input.val().trim();if((e.which&&13==e.which||e.keyCode&&13==e.keyCode)&&t){var o=new app.TodoModel({title:t});app.todos.create(o),app.todos.trigger("addOne",o),this.$input.val("")}},loadTodos:function(){app.todos.each(this.loadTodo,this)},loadTodo:function(e){var t=new app.TodoItemView({model:e}),o=t.render().$el;o.hide(),o.appendTo(this.$todoList),o.slideDown()},render:function(){var e=app.todos.done().length,t=app.todos.remaining().length;app.todos.length?(this.$main.show(),this.$footer.slideDown(),this.$footer.html(this.statsTemplate({done:e,remaining:t})),this.$footer.find("a").removeClass("selected").filter("[href='#"+app.todoFilter+"']").addClass("selected")):(this.$main.slideUp("fast"),this.$footer.slideUp())},filterOne:function(e){e.trigger("hide")},filterAll:function(){app.todos.each(this.filterOne)},initialize:function(){this.$todoList=this.$(".todo-list"),this.$input=this.$("input"),this.$footer=this.$(".footer"),this.$main=this.$(".main"),this.listenTo(app.todos,"reset",this.loadTodos),this.listenTo(app.todos,"addOne",this.loadTodo),this.listenTo(app.todos,"filter",this.filterAll),this.listenTo(app.todos,"all",this.render),app.todos.fetch({reset:!0})}}),new app.TodoAppView}(),function(){app.TodoRouter=Backbone.Router.extend({routes:{"*filter":"do"},do:function(e){app.todoFilter=e||"",app.todos.trigger("filter")}}),app.router=new app.TodoRouter,Backbone.history.start()}();
//# sourceMappingURL=all.min.js.map
